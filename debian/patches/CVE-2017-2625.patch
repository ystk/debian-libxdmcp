Index: libxdmcp-1.1.1/Key.c
===================================================================
--- libxdmcp-1.1.1.orig/Key.c	2012-03-08 04:46:35.000000000 +0100
+++ libxdmcp-1.1.1/Key.c	2019-11-25 12:01:25.642958795 +0100
@@ -56,9 +56,16 @@
 #define getpid(x) _getpid(x)
 #endif
 
+#ifdef HAVE_LIBBSD
+#include <bsd/stdlib.h> /* for arc4random_buf() */
+#endif
+
 void
 XdmcpGenerateKey (XdmAuthKeyPtr key)
 {
+#ifdef HAVE_ARC4RANDOM_BUF
+    arc4random_buf(key->data, 8);
+#else
     long    lowbits, highbits;
 
     srandom ((int)getpid() ^ time((Time_t *)0));
@@ -66,6 +73,7 @@
     highbits = random ();
     getbits (lowbits, key->data);
     getbits (highbits, key->data + 4);
+#endif
 }
 
 int
Index: libxdmcp-1.1.1/configure.ac
===================================================================
--- libxdmcp-1.1.1.orig/configure.ac	2012-03-08 04:46:35.000000000 +0100
+++ libxdmcp-1.1.1/configure.ac	2019-11-25 11:46:51.167550086 +0100
@@ -55,6 +55,9 @@
 # Checks for library functions.
 AC_CHECK_FUNCS([srand48 lrand48])
 
+AC_CHECK_LIB([bsd], [arc4random_buf])
+AC_CHECK_FUNCS([arc4random_buf])
+
 # Obtain compiler/linker options for depedencies
 PKG_CHECK_MODULES(XDMCP, xproto)
 
